import numpy as np

PERIODS = np.array([0.01, 0.05, 0.063, 0.079, 0.1, 0.125, 0.16, 0.2, 0.25, 0.32, 0.4, 0.5, 0.63, 0.79, 1.0, 1.26, 1.59, 2.0, 2.5, 3.125, 4.0, 5.0, 6.25, 7.69, 10.0])

c0 = [5.006, 5.843, 5.823, 5.676, 5.49, 5.209, 4.93, 4.746, 4.472, 4.303, 4.167, 3.999, 3.859, 3.733, 3.621, 3.453, 3.393, 3.241, 3.104, 2.978, 2.814, 2.671, 2.569, 2.489, 2.338]

c1 = [-1.5573, -1.9391, -1.8889, -1.7633, -1.6257, -1.4404, -1.2671, -1.1691, -1.0133, -0.9322, -0.8854, -0.8211, -0.7746, -0.7473, -0.7376, -0.6885, -0.7101, -0.6741, -0.6585, -0.6431, -0.6108, -0.5942, -0.6048, -0.6412, -0.6311]

c2 = [-0.00034, 0, -0.00022, -0.00071, -0.00115, -0.00163, -0.00204, -0.00212, -0.00234, -0.00231, -0.00211, -0.00195, -0.00179, -0.00159, -0.00128, -0.00119, -0.00089, -0.00081, -0.00063, -0.00057, -0.00046, -0.0004, -0.00024, -0.00003, 0]

c3 = [0.1774, 0.1813, 0.1845, 0.1784, 0.1736, 0.1788, 0.1645, 0.1593, 0.1713, 0.1713, 0.1802, 0.187, 0.201, 0.2035, 0.2116, 0.2417, 0.2483, 0.2696, 0.299, 0.3258, 0.349, 0.3822, 0.4324, 0.476, 0.5357]

c4 = [0.0827, 0.0199, 0.016, 0.0245, 0.0261, 0.0151, 0.0301, 0.0432, 0.0255, 0.027, 0.0258, 0.0271, 0.0153, 0.0292, 0.0328, 0.0125, 0.0103, -0.0064, -0.0074, -0.0103, -0.0299, -0.0417, -0.0641, -0.0629, -0.0737]

SIG = [0.24, 0.26, 0.26, 0.27, 0.27, 0.27, 0.27, 0.27, 0.27, 0.27, 0.27, 0.27, 0.28, 0.28, 0.29, 0.29, 0.29, 0.3, 0.3, 0.3, 0.3, 0.32, 0.34, 0.35, 0.38]

def computeSpectra(mag, r, per):
    pIdx = np.nonzero(PERIODS == per)[0][0]
    ci = c0[pIdx] + c3[pIdx] * (mag - 8) + c4[pIdx] * (mag - 8)**2
    h = mag ** 2 - 3.1 * mag - 14.55
    reff = np.sqrt(r**2 + h**2)
    logSa = ci + c1[pIdx] * np.log10(reff) + c2[pIdx] * reff
    return logSa

def sigma(periods):
    sig = [np.interp(np.log10(per) , np.log10(PERIODS) , SIG) for per in periods]
    return sig
